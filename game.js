!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports={BLOCK_SIZE:32,BOARD_HEIGHT:20,BOARD_WIDTH:10}},function(e,t,r){r(2);var n=r(3),o=r(4);window.onload=function(){var e=new PIXI.Application({width:400,height:700,backgroundColor:1087931,resolution:1});e.loader.add("block-empty","images/empty.png"),e.loader.add("block-i","images/I.png"),e.loader.add("block-j","images/J.png"),e.loader.add("block-l","images/L.png"),e.loader.add("block-o","images/O.png"),e.loader.add("block-s","images/S.png"),e.loader.add("block-t","images/T.png"),e.loader.add("block-z","images/Z.png"),document.getElementById("game").appendChild(e.view),e.loader.onComplete.add((function(){var t=new o({resources:e.loader.resources});e.stage.addChild(t.board);var r=new Date;e.ticker.add((function(){if(!t.gameOver){var e=new Date,o=n.getKeyPress();o===n.KEYS.KEY_UP&&t.rotate(-1),o===n.KEYS.KEY_DOWN&&t.rotate(1),o===n.KEYS.KEY_LEFT&&t.move(-1),o===n.KEYS.KEY_RIGHT&&t.move(1),(e-r>=300||o===n.KEYS.KEY_SPACE)&&(r=new Date,t.fall()),t.update()}}))})),e.loader.load()}},function(e,t,r){},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=null,this.addEvents()}var t,n,o;return t=e,(n=[{key:"addEvents",value:function(){var e=this;return window.addEventListener("keydown",(function(t){null===e.key&&(e.key=t.keyCode)})),window.addEventListener("keyup",(function(t){e.key=null})),this}},{key:"getKeyPress",value:function(){var e=this.key;return this.key=null,e}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports=new n,e.exports.KEYS={KEY_DOWN:40,KEY_UP:38,KEY_LEFT:37,KEY_RIGHT:39,KEY_SPACE:32}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(0),i=o.BOARD_HEIGHT,a=o.BOARD_WIDTH,s=r(5),u=r(8),c=function(){function e(t){var r=t.board,n=t.resources;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.board=r||new u({resources:n}),this.gameOver=!1,this.MOVEMENT_TYPES={ROTATE:"ROTATE",RIGHT:"RIGHT",LEFT:"LEFT",DOWN:"DOWN"},this.currTetromino=new s({}),this.tetrominos=[];for(var o=0;o<5;o++)this.tetrominos.push(new s({}));this.board.init(),this.board.spawn(this.currTetromino)}var t,r,o;return t=e,(r=[{key:"canMove",value:function(e,t){var r=e.shape,n=e.row,o=e.row+(r.length-1),s=e.col,u=e.col+(r.length-1);t===this.MOVEMENT_TYPES.DOWN&&(n+=1,o+=1),t===this.MOVEMENT_TYPES.LEFT&&(s-=1,u-=1),t===this.MOVEMENT_TYPES.RIGHT&&(s+=1,u+=1),t===this.MOVEMENT_TYPES.ROTATE&&(r=e.type.shapes[e.nextRotation(1)]);for(var c=!0,l=0,f=n;f<=o;f++){for(var h=0,d=s;d<=u;d++){if(f<=i-1)if(d>=0&&d<=a-1){if(this.board.grid[f][d]&&r[l][h]){c=!1;break}}else r[l][h]&&(c=!1);else r[l][h]&&(c=!1);h++}if(!c)break;l++}return c}},{key:"fall",value:function(){this.currTetromino&&this.canMove(this.currTetromino,"DOWN")?this.currTetromino.fall():this.fusion()}},{key:"move",value:function(e){this.currTetromino&&(-1===e?this.canMove(this.currTetromino,"LEFT")&&this.currTetromino.move(e):this.canMove(this.currTetromino,"RIGHT")&&this.currTetromino.move(e))}},{key:"rotate",value:function(e){this.canMove(this.currTetromino,"ROTATE")&&this.currTetromino.rotate(e)}},{key:"fusion",value:function(){this.board.merge(this.currTetromino);var e=this.tetrominos.splice(0,1);this.tetrominos.push(new s({})),this.currTetromino=e[0],this.checkForLines(),this.board.spawn(this.currTetromino),this.canMove(this.currTetromino)||(this.gameOver=!0,console.log("GAME OVER"))}},{key:"checkForLines",value:function(){for(var e=[],t=0;t<this.board.grid.length;t++){for(var r=!0,n=0;n<this.board.grid[t].length;n++)this.board.grid[t][n]||(r=!1);r&&e.push(t)}for(var o=this.board.grid.slice(),i=0;i<e.length;i++)o.splice(e[i]-i,1);for(var s=0;s<e.length;s++)o.unshift(new Array(a).fill(0));this.board.grid=o}},{key:"update",value:function(){this.board.update(this.currTetromino)}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=c},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(0).BOARD_WIDTH,i=r(6),a=r(7).randomBetween,s=function(){function e(t){var r=t.row,n=t.col,i=t.type,a=t.rotation;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.blocks=[],this.currRotation=void 0!==a?a:0,this.realRotation=this.currRotation,this.type=i||this.getRandomType(),this.shape=this.type.shapes[this.currRotation],this.row=void 0!==r?r:0,this.col=void 0!==n?n:Math.ceil((o-1)/2-this.type.size/2)}var t,r,s;return t=e,(r=[{key:"getRandomType",value:function(){var e=a(1,7)-1;return i[Object.keys(i)[e]]}},{key:"move",value:function(e){this.col=this.col+e}},{key:"fall",value:function(){this.row++}},{key:"nextRotation",value:function(e){return Math.abs(this.realRotation+e)%4}},{key:"rotate",value:function(e){this.realRotation=this.realRotation+e;var t=Math.abs(this.realRotation)%4;this.currRotation=t,this.shape=this.type.shapes[this.currRotation]}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},function(e,t){e.exports={I:{name:"I",texture:"block-i",size:4,shapes:[[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]]},J:{name:"J",texture:"block-j",size:3,shapes:[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]]},L:{name:"L",texture:"block-l",size:3,shapes:[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]]},O:{name:"O",texture:"block-o",size:2,shapes:[[[1,1],[1,1]],[[1,1],[1,1]],[[1,1],[1,1]],[[1,1],[1,1]]]},S:{name:"S",texture:"block-s",size:3,shapes:[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]]},T:{name:"T",texture:"block-t",size:3,shapes:[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]]},Z:{name:"Z",texture:"block-z",size:3,shapes:[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]],[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]]}}},function(e,t){e.exports={randomBetween:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=r(0),l=c.BLOCK_SIZE,f=c.BOARD_WIDTH,h=c.BOARD_HEIGHT,d=r(9),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(y,PIXI.Container);var t,r,n,c,p=(t=y,function(){var e,r=u(t);if(s()){var n=u(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return a(this,e)});function y(e){var t,r=e.resources;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=p.call(this)).res=r,t.grid=t.createEmptyBoard(),t.visibleGrid=t.createEmptyBoard(),t}return r=y,(n=[{key:"createEmptyBoard",value:function(){return new Array(h).fill(0).map((function(){return new Array(f).fill(0)}))}},{key:"init",value:function(){for(var e=0;e<this.grid.length;e++)for(var t=0;t<this.grid[e].length;t++){var r=new d(this.res["block-empty"].texture,l);r.el.position.x=t*l,r.el.position.y=e*l,this.visibleGrid[e][t]=r.el,this.addChild(r.el)}}},{key:"spawn",value:function(e){this.update(e)}},{key:"merge",value:function(e){this.grid=this.getGridWithTetromino(e)}},{key:"update",value:function(e){this.draw(this.getGridWithTetromino(e))}},{key:"getGridWithTetromino",value:function(e){for(var t=this.createEmptyBoard(),r=0,n=0;n<this.grid.length;n++){for(var o=e.col<0?Math.abs(e.col):0,i=!1,a=0;a<this.grid[n].length;a++)n>=e.row&&n<e.row+e.type.size&&a>=e.col&&a<e.col+e.type.size?(e.type.shapes[e.currRotation][r][o]?t[n][a]=e.type.texture:t[n][a]=this.grid[n][a],i=!0):t[n][a]=this.grid[n][a],i&&o++;i&&r++}return t}},{key:"draw",value:function(e){for(var t=0;t<this.grid.length;t++)for(var r=0;r<this.grid[t].length;r++)0!==e[t][r]?this.visibleGrid[t][r].texture=this.res[e[t][r]].texture:this.visibleGrid[t][r].texture=this.grid[t][r]?this.visibleGrid[t][r].texture:this.res["block-empty"].texture}}])&&o(r.prototype,n),c&&o(r,c),y}();e.exports=p},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(0).BLOCK_SIZE,a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;n(this,e),this.el=this.draw(t,r)}var t,r,a;return t=e,(r=[{key:"draw",value:function(e,t){var r=new PIXI.Sprite(e);return r.position.x=0,r.position.y=0,r.width=t,r.height=t,r}}])&&o(t.prototype,r),a&&o(t,a),e}();e.exports=a}]);